<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web App Layout</title>
    <link rel="stylesheet" href="style.css">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var $input = document.querySelector('.box__file'); // L'input file del form
            var $form = document.querySelector('.center-box'); // Il contenitore center-box
            var videoElement = null; // Dichiarare fuori per l'uso globale
    
            $input.addEventListener('change', function(e) {
                var files = e.target.files; // Ottiene il file selezionato
                if (files.length > 0) {
                    var file = files[0]; // Prendi il primo file (video)
                    
                    if (file.type.startsWith('video/')) {
                        var reader = new FileReader(); // Creiamo un oggetto FileReader
                        
                        reader.onload = function(event) {
                            videoElement = document.createElement('video'); // Creiamo un elemento video
                            videoElement.classList.add('custom-video'); // Aggiungiamo una classe per lo stile
                            videoElement.src = event.target.result; // Imposta la sorgente del video dal file caricato
                            videoElement.muted = true; // Muto per prevenire audio automatico
                            videoElement.controls = false; // Disabilita i controlli nativi
    
                            // Pulisce eventuali video precedenti dalla center-box
                            $form.innerHTML = ''; 
    
                            // Inserisce il video dentro la center-box
                            $form.appendChild(videoElement);
                        };
    
                        reader.readAsDataURL(file); // Legge il file come URL
                    } else {
                        alert('Per favore carica un file video.'); // Messaggio di errore se il file non è un video
                    }
                }
            });
    
            // Aggiungi un listener globale per la barra spaziatrice
            document.addEventListener('keydown', function(event) {
                if (event.code === 'Space' && videoElement) {
                    event.preventDefault(); // Previene il comportamento predefinito della barra spaziatrice
                    if (videoElement.paused) {
                        videoElement.play(); // Se il video è in pausa, fallo partire
                    } else {
                        videoElement.pause(); // Se il video è in riproduzione, mettilo in pausa
                    }
                }
            });
        });
    </script>
    
    
    
</head>
<body>
    <div class="container">
        <div class="column" id="column_left"> <!-- Colonna sinistra -->
            <div class="row">
                <button class="button">Salvatore's button</button>
            </div>
        </div> 
        
        <div class="center-column"> <!-- Colonna centrale con contenuto -->
            <div class="center_box_container">
                <div class="center-box">
                    <!-- Contenuto form centrale -->
                    <form class="box" method="post" action="/upload" enctype="multipart/form-data">
                        <div class="box__input">
                            <input class="box__file" type="file" name="files[]" id="file" accept="video/*" />
                            <label for="file"><strong>Drag it here</strong></label>
                        </div>
                        <div class="box__uploading">Uploading…</div>
                        <div class="box__success">Done!</div>
                        <div class="box__error">Error! <span></span>.</div>
                    </form>
                </div>
            </div>
            
            <div class="row">
                <div class="bottom-box">
                    <div class="row">
                        <div class="knob-surround"> 
                            <div class="knob" id="knob1"></div>
                        </div>
                        <div id="preview_display">
                            <div class="line" id="movingLine"></div>
                        </div>
                        <div class="knob-surround"> 
                            <div class="knob" id="knob2"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="signature">
                            Les Lunettes de Dalì
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="column" id="column_right"></div> <!-- Colonna destra -->
    </div>
    
    <script type="text/javascript" src="/jquery-3.7.1.js"></script>
    <script type="text/javascript" src="/java.js"></script>
</body>
</html>


